#!/usr/bin/env perl
($z,$y,$x,$w,$v,$u)=@ARGV;srand();$z=4 if!$z||$z=~m|[^\d]|;$y=join('',map{int(rand(2))}(1..($z*4)))if!$y||$y!~m$[01]$;$x=1 if!$x||$x=~m&[^\d]&;$w=120 if!$w||$w=~m%[^\d]%&& $w!~m+^(inf(init(y|e))?$)+;$v='%' if!defined$v;$u='~' if!defined$u;@t=split('',$y);map{$s=$_;map{$r[$s][$_]=shift@t}(0..($z-1))}(0..($z-1));$q{join('',map{$n=$_;join('',@{$n})}@r)}++;print'='x$z.$h++."\n".join('',map{$f=$_;join('',map{$_?$v:$u}@{$f})."\n"}@r)."\n";while(!$o){map{$m=$_;map{$l=$r[$m][$_];$j=0;map{$j+=$r[$_->[0]][$_->[1]];}([($m-1)<0?($z-1):($m-1),$_],[($m+1)>($z-1)?0:($m+1),$_],[$m,($_+1)>($z-1)?0:($_+1)],[$m,($_-1)<0?($z-1):($_-1)],[($m+1)>($z-1)?0:($m+1),($_+1)>($z-1)?0:($_+1)],[($m+1)>($z-1)?0:($m+1),($_-1)<0?($z-1):($_-1)],[($m-1)<0?($z-1):($m-1),($_+1)>($z-1)?0:($_+1)],[($m-1)<0?($z-1):($m-1),($_-1)<0?($z-1):($_-1)]);$i[$m][$_]=$l?($j>3||$j<2)?0:1:$j==3?1:0;}(0..($z-1))}(0..($z-1));@r=@i;sleep($x);$d=0;map{$n=$_;map{$d+=$_}@{$n}}@r;$g=$q{join('',map{$n=$_;join('',@{$n})}@r)}++;$o+=$d?$g<10?$h<$w?0:$w !~m}^inf(init(y|e))?$}i?0:1:1:1;print'='x$z.$h++.($g?$g>9?" Stable":'*':'').($d?'':" It's dead, Jim!")."\n".join('',map{$e=$_;join('',map{$_?$v:$u}@{$e})."\n"}@r)."\n";}
